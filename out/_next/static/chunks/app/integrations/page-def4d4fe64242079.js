(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[528],{88:(e,t,s)=>{"use strict";s.d(t,{d:()=>i});var n=s(5155);s(2115);var a=s(4884),r=s(3999);function i(e){let{className:t,...s}=e;return(0,n.jsx)(a.bL,{"data-slot":"switch",className:(0,r.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,n.jsx)(a.zi,{"data-slot":"switch-thumb",className:"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"})})}},2188:(e,t,s)=>{"use strict";s.d(t,{N:()=>S});var n=s(5155),a=s(2115),r=s(6874),i=s.n(r),l=s(5695),o=s(7168),c=s(3783),d=s(4516),u=s(2970),h=s(3314),m=s(4213),x=s(2292),g=s(7213),f=s(9588),p=s(381),v=s(3311),j=s(1007),b=s(4835),y=s(4416),_=s(4783),N=s(3999),w=s(1886);function S(e){let{children:t}=e,s=(0,l.usePathname)(),r=(0,l.useRouter)(),[S,k]=(0,a.useState)({}),[A,I]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{let e=await w.u.getSessionUser();e.data&&k(e.data)}catch(e){console.error("Error fetching users:",e)}})()},[]);let E=[{name:"Dashboard",href:"/dashboard",icon:c.A},{name:"Map",href:"/dashboard/map",icon:d.A},{name:"Connections",href:"/dashboard/connections",icon:u.A},{name:"Models",href:"/dashboard/models",icon:h.A},{name:"Knowledge",href:"/dashboard/knowledge",icon:m.A},{name:"Integrations",href:"/integrations",icon:x.A},{name:"Images",href:"/dashboard/images",icon:g.A},{name:"Audio",href:"/dashboard/audio",icon:f.A},{name:"Settings",href:"/dashboard/settings",icon:p.A}],O=()=>{w.u.logout(),r.push("/auth/login")};return(0,n.jsxs)("div",{className:"min-h-screen flex",children:[(0,n.jsx)("aside",{className:"hidden lg:flex lg:flex-col lg:w-64 glass-strong border-r border-primary/20 fixed h-screen",children:(0,n.jsxs)("div",{className:"flex-1 flex flex-col p-6 space-y-6",children:[(0,n.jsxs)(i(),{href:"/dashboard",className:"flex items-center gap-3 group",children:[(0,n.jsx)("div",{className:"p-2 glass rounded-lg border border-primary/30 group-hover:border-primary/50 transition-all",children:(0,n.jsx)(v.A,{className:"w-6 h-6 text-primary"})}),(0,n.jsx)("span",{className:"text-xl font-bold neon-text",children:"JARVIS"})]}),(0,n.jsx)("nav",{className:"flex-1 space-y-1",children:E.map(e=>{let t=s===e.href;return(0,n.jsx)(i(),{href:e.href,children:(0,n.jsxs)(o.$,{variant:"ghost",className:(0,N.cn)("w-full justify-start gap-3 hover:bg-primary/10 hover:text-primary transition-all",t&&"bg-primary/20 text-primary neon-glow"),children:[(0,n.jsx)(e.icon,{className:"w-5 h-5"}),e.name]})},e.name)})}),(0,n.jsxs)("div",{className:"space-y-2 pt-4 border-t border-border/50",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 p-3 glass rounded-lg border border-primary/20",children:[(0,n.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center",children:(0,n.jsx)(j.A,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium truncate",children:S.name}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:S.email})]})]}),(0,n.jsxs)(o.$,{variant:"outline",className:"w-full glass border-destructive/30 text-destructive hover:bg-destructive/10 bg-transparent",onClick:O,children:[(0,n.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})}),A&&(0,n.jsxs)("div",{className:"lg:hidden fixed inset-0 z-50",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>I(!1)}),(0,n.jsxs)("aside",{className:"absolute left-0 top-0 bottom-0 w-64 glass-strong border-r border-primary/20 p-6 space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(i(),{href:"/dashboard",className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"p-2 glass rounded-lg border border-primary/30",children:(0,n.jsx)(v.A,{className:"w-6 h-6 text-primary"})}),(0,n.jsx)("span",{className:"text-xl font-bold neon-text",children:"JARVIS"})]}),(0,n.jsx)(o.$,{variant:"ghost",size:"icon",onClick:()=>I(!1),children:(0,n.jsx)(y.A,{className:"w-5 h-5"})})]}),(0,n.jsx)("nav",{className:"space-y-1",children:E.map(e=>{let t=s===e.href;return(0,n.jsx)(i(),{href:e.href,onClick:()=>I(!1),children:(0,n.jsxs)(o.$,{variant:"ghost",className:(0,N.cn)("w-full justify-start gap-3 hover:bg-primary/10 hover:text-primary transition-all",t&&"bg-primary/20 text-primary neon-glow"),children:[(0,n.jsx)(e.icon,{className:"w-5 h-5"}),e.name]})},e.name)})}),(0,n.jsx)("div",{className:"absolute bottom-6 left-6 right-6",children:(0,n.jsxs)(o.$,{variant:"outline",className:"w-full glass border-destructive/30 text-destructive hover:bg-destructive/10 bg-transparent",onClick:O,children:[(0,n.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Logout"]})})]})]}),(0,n.jsxs)("div",{className:"flex-1 lg:ml-64",children:[(0,n.jsx)("header",{className:"lg:hidden sticky top-0 z-40 glass-strong border-b border-primary/20 p-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(o.$,{variant:"ghost",size:"icon",onClick:()=>I(!0),children:(0,n.jsx)(_.A,{className:"w-5 h-5"})}),(0,n.jsxs)(i(),{href:"/dashboard",className:"flex items-center gap-2",children:[(0,n.jsx)(v.A,{className:"w-5 h-5 text-primary"}),(0,n.jsx)("span",{className:"font-bold neon-text",children:"JARVIS"})]}),(0,n.jsx)("div",{className:"w-10"})]})}),(0,n.jsx)("main",{className:"p-6 lg:p-8",children:t})]})]})}},2714:(e,t,s)=>{"use strict";s.d(t,{J:()=>i});var n=s(5155);s(2115);var a=s(968),r=s(3999);function i(e){let{className:t,...s}=e;return(0,n.jsx)(a.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}},3580:(e,t,s)=>{"use strict";s.d(t,{dj:()=>h,oR:()=>u});var n=s(2115);let a=0,r=new Map,i=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||n()}}}),{id:s,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function h(){let[e,t]=n.useState(c);return n.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},4964:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>o,av:()=>c,j7:()=>l,tU:()=>i});var n=s(5155);s(2115);var a=s(704),r=s(3999);function i(e){let{className:t,...s}=e;return(0,n.jsx)(a.bL,{"data-slot":"tabs",className:(0,r.cn)("flex flex-col gap-2",t),...s})}function l(e){let{className:t,...s}=e;return(0,n.jsx)(a.B8,{"data-slot":"tabs-list",className:(0,r.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...s})}function o(e){let{className:t,...s}=e;return(0,n.jsx)(a.l9,{"data-slot":"tabs-trigger",className:(0,r.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function c(e){let{className:t,...s}=e;return(0,n.jsx)(a.UC,{"data-slot":"tabs-content",className:(0,r.cn)("flex-1 outline-none",t),...s})}},6675:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var n=s(5155),a=s(2115),r=s(4964),i=s(4298),l=s(8482),o=s(7168),c=s(9852),d=s(2714),u=s(8524),h=s(8145),m=s(9840),x=s(1886),g=s(3580);function f(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)([]),[f,p]=(0,a.useState)(!0),[v,j]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),[_,N]=(0,a.useState)(null),[w,S]=(0,a.useState)({}),[k,A]=(0,a.useState)([]),[I,E]=(0,a.useState)(!1),[O,C]=(0,a.useState)(null),T=(0,a.useRef)(null);(0,a.useEffect)(()=>(D(),R(),()=>{T.current&&T.current.disconnect()}),[]);let D=async()=>{try{p(!0);let e=await x.u.getHomeAssistantIntegrations();e.success&&e.data&&t(e.data)}catch(e){j("Failed to fetch integrations"),console.error("Error fetching integrations:",e)}finally{p(!1)}},R=async()=>{try{let e=await x.u.getAvailableIntegrations();e.success&&e.data&&r(e.data)}catch(e){j("Failed to fetch available integrations"),console.error("Error fetching available integrations:",e)}},F=e=>{N(e),S({}),y(!0)},z=(e,t)=>{S(s=>({...s,[e]:t}))},L=async()=>{if(_)try{E(!0),A([]),M();let e=await x.u.startIntegrationFlow(_.id,w);e.success&&e.data?C(e.data.flow_id):(j(e.error||"Failed to start integration flow"),E(!1))}catch(e){j("Failed to start integration flow"),console.error("Error starting integration flow:",e),E(!1)}},M=()=>{T.current&&T.current.disconnect();let e=(0,i.io)("http://localhost:8080",{path:"/api/ws/integrations/flow",transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});e.on("connect",()=>{console.log("Connected to integration flow Socket.IO")}),e.on("flow_started",e=>{A(t=>[...t,e])}),e.on("flow_progress",e=>{A(t=>[...t,e])}),e.on("flow_completed",e=>{var t,s;A(t=>[...t,e]),E(!1),(null===(t=e.data)||void 0===t?void 0:t.success)?((0,g.oR)({title:"Success",description:"Integration configured successfully!"}),D()):(0,g.oR)({title:"Error",description:(null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to configure integration",variant:"destructive"})}),e.on("connect_error",e=>{console.error("Integration flow Socket.IO connection error:",e),j("Integration flow Socket.IO connection error: "+e.message)}),e.on("error",e=>{console.error("Socket.IO error:",e),j("Socket.IO error: "+(e.message||"Unknown error"))}),e.on("disconnect",t=>{console.log("Socket.IO connection closed:",t),"io server disconnect"===t&&e.connect()}),T.current=e},B=async e=>{try{let t=await x.u.enableHomeAssistantIntegration(e);t.success?(D(),(0,g.oR)({title:"Success",description:"Integration enabled successfully"})):j(t.error||"Failed to enable integration")}catch(e){j("Failed to enable integration"),console.error("Error enabling integration:",e)}},H=async e=>{try{let t=await x.u.disableHomeAssistantIntegration(e);t.success?(D(),(0,g.oR)({title:"Success",description:"Integration disabled successfully"})):j(t.error||"Failed to disable integration")}catch(e){j("Failed to disable integration"),console.error("Error disabling integration:",e)}};return f?(0,n.jsx)("div",{className:"p-4",children:"Loading integrations..."}):v?(0,n.jsxs)("div",{className:"p-4 text-red-500",children:["Error: ",v]}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(l.Zp,{children:[(0,n.jsx)(l.aR,{children:(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(l.ZB,{children:"Home Assistant Integrations"}),(0,n.jsx)(l.BT,{children:"Manage your Home Assistant integrations"})]})})}),(0,n.jsx)(l.Wu,{children:(0,n.jsxs)(u.XI,{children:[(0,n.jsx)(u.A0,{children:(0,n.jsxs)(u.Hj,{children:[(0,n.jsx)(u.nd,{children:"Name"}),(0,n.jsx)(u.nd,{children:"ID"}),(0,n.jsx)(u.nd,{children:"Version"}),(0,n.jsx)(u.nd,{children:"Status"}),(0,n.jsx)(u.nd,{children:"Actions"})]})}),(0,n.jsx)(u.BF,{children:e.map(e=>(0,n.jsxs)(u.Hj,{children:[(0,n.jsx)(u.nA,{className:"font-medium",children:e.name}),(0,n.jsx)(u.nA,{children:e.integration_id}),(0,n.jsx)(u.nA,{children:e.version}),(0,n.jsx)(u.nA,{children:(0,n.jsx)(h.E,{variant:e.enabled?"default":"secondary",children:e.enabled?"Enabled":"Disabled"})}),(0,n.jsx)(u.nA,{children:(0,n.jsx)("div",{className:"flex space-x-2",children:e.enabled?(0,n.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>H(e.integration_id),children:"Disable"}):(0,n.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>B(e.integration_id),children:"Enable"})})})]},e.id))})]})})]}),(0,n.jsxs)(l.Zp,{children:[(0,n.jsxs)(l.aR,{children:[(0,n.jsx)(l.ZB,{children:"Available Integrations"}),(0,n.jsx)(l.BT,{children:"Discover and add new integrations"})]}),(0,n.jsx)(l.Wu,{children:(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>(0,n.jsxs)(l.Zp,{className:"p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium",children:e.name}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,n.jsx)(h.E,{variant:"secondary",className:"mt-2",children:e.category})]}),e.icon&&(0,n.jsx)("img",{src:e.icon,alt:e.name,className:"w-10 h-10 object-contain"})]}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(o.$,{onClick:()=>F(e),className:"w-full",children:"Add Integration"})})]},e.id))})})]}),(0,n.jsx)(m.lG,{open:b,onOpenChange:y,children:(0,n.jsxs)(m.Cf,{className:"max-w-2xl",children:[(0,n.jsx)(m.c7,{children:(0,n.jsx)(m.L3,{children:_?"Configure ".concat(_.name):"Configure Integration"})}),I?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"font-medium",children:"Configuration Progress"}),(0,n.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.map((e,t)=>{var s,a;return(0,n.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,n.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary mt-2 flex-shrink-0"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm",children:(null===(s=e.data)||void 0===s?void 0:s.message)||"".concat(e.event_type," at ").concat(new Date(e.timestamp).toLocaleTimeString())}),(null===(a=e.data)||void 0===a?void 0:a.step)&&(0,n.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Step: ",e.data.step]})]})]},t)})}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"})})]}):_?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:_.description}),(0,n.jsx)("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:_.config_fields.map(e=>(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)(d.J,{htmlFor:e.id,children:[e.label," ",e.required&&(0,n.jsx)("span",{className:"text-destructive",children:"*"})]}),"password"===e.type?(0,n.jsx)(c.p,{id:e.id,type:"password",value:w[e.id]||"",onChange:t=>z(e.id,t.target.value),required:e.required}):(0,n.jsx)(c.p,{id:e.id,type:"text",value:w[e.id]||"",onChange:t=>z(e.id,t.target.value),required:e.required})]},e.id))}),(0,n.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,n.jsx)(o.$,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),(0,n.jsx)(o.$,{onClick:L,children:"Start Configuration"})]})]}):(0,n.jsx)("div",{className:"text-center py-4",children:(0,n.jsx)("p",{children:"No integration selected"})})]})})]})}var p=s(88);function v(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)([]),[c,d]=(0,a.useState)({}),[m,f]=(0,a.useState)(!0),[v,j]=(0,a.useState)(null),b=(0,a.useRef)(null);(0,a.useEffect)(()=>(y(),_(),N(),()=>{b.current&&b.current.disconnect()}),[]);let y=async()=>{try{f(!0),t([{id:1,config_entries:["smartthings"],connections:{},identifiers:{smartthings:"device_1"},manufacturer:"SmartThings",model:"Smart Bulb",name:"Living Room Light",area_id:null,via_device_id:null,serial_number:null,sw_version:null,hw_version:null,configuration_url:null,disabled_by:null,entry_type:null,discovery_method:"smartthings"},{id:2,config_entries:["tuya"],connections:{},identifiers:{tuya:"tuya_device_1"},manufacturer:"Tuya",model:"Smart Plug",name:"Kitchen Smart Plug",area_id:null,via_device_id:null,serial_number:null,sw_version:null,hw_version:null,configuration_url:null,disabled_by:null,entry_type:null,discovery_method:"tuya"}])}catch(e){j("Failed to fetch devices"),console.error("Error fetching devices:",e)}finally{f(!1)}},_=async()=>{try{r([{entity_id:"light.smartthings_device_1",unique_id:"smartthings_device_1",platform:"smartthings",domain:"light",name:"Living Room Light",device_id:"1",area_id:null,icon:null,disabled_by:null,hidden_by:null,entity_category:null,has_entity_name:null,original_name:null,capabilities:null,supported_features:null,device_class:null,unit_of_measurement:null,state_class:null,last_updated:null},{entity_id:"switch.tuya_tuya_device_1",unique_id:"tuya_tuya_device_1",platform:"tuya",domain:"switch",name:"Kitchen Smart Plug",device_id:"2",area_id:null,icon:null,disabled_by:null,hidden_by:null,entity_category:null,has_entity_name:null,original_name:null,capabilities:null,supported_features:null,device_class:null,unit_of_measurement:null,state_class:null,last_updated:null}]);let e={"light.smartthings_device_1":{entity_id:"light.smartthings_device_1",state:"on",attributes:{brightness:100},last_changed:new Date().toISOString(),last_updated:new Date().toISOString()},"switch.tuya_tuya_device_1":{entity_id:"switch.tuya_tuya_device_1",state:"off",attributes:{current:"0A"},last_changed:new Date().toISOString(),last_updated:new Date().toISOString()}};d(e)}catch(e){j("Failed to fetch entities"),console.error("Error fetching entities:",e)}},N=()=>{b.current&&b.current.disconnect();let e=(0,i.io)("http://localhost:8080",{path:"/api/ws/entities",transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});e.on("connect",()=>{console.log("Connected to entity Socket.IO")}),e.on("state_changed",e=>{try{if("state_changed"===e.type){let{entity_id:t,new_state:s}=e.data;d(e=>({...e,[t]:{entity_id:t,state:s.state,attributes:s.attributes||{},last_changed:new Date().toISOString(),last_updated:new Date().toISOString()}}))}}catch(e){console.error("Error parsing Socket.IO message:",e)}}),e.on("event",e=>{console.log("Received event:",e)}),e.on("connect_error",e=>{console.error("Entity Socket.IO connection error:",e),j("Entity Socket.IO connection error: "+e.message)}),e.on("error",e=>{console.error("Entity Socket.IO error:",e),j("Entity Socket.IO error: "+(e.message||"Unknown error"))}),e.on("disconnect",t=>{console.log("Entity Socket.IO connection closed:",t),"io server disconnect"===t&&e.connect()}),b.current=e},w=async(e,t,s)=>{try{let n=await x.u.callHomeAssistantService(t,s,{entity_id:e});n.success?(0,g.oR)({title:"Success",description:"Successfully sent command to ".concat(e)}):(j(n.error||"Failed to control device"),(0,g.oR)({title:"Error",description:n.error||"Failed to control device",variant:"destructive"}))}catch(e){j("Failed to control device"),console.error("Error controlling device:",e),(0,g.oR)({title:"Error",description:"Failed to control device",variant:"destructive"})}},S=e=>{var t;let s=null===(t=c[e.entity_id])||void 0===t?void 0:t.state;w(e.entity_id,e.domain,"on"==("on"===s?"off":"on")?"turn_on":"turn_off")};return m?(0,n.jsx)("div",{className:"p-4",children:"Loading devices and entities..."}):v?(0,n.jsxs)("div",{className:"p-4 text-red-500",children:["Error: ",v]}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(l.Zp,{children:[(0,n.jsx)(l.aR,{children:(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(l.ZB,{children:"Devices"}),(0,n.jsx)(l.BT,{children:"Manage your smart home devices"})]})})}),(0,n.jsx)(l.Wu,{children:(0,n.jsxs)(u.XI,{children:[(0,n.jsx)(u.A0,{children:(0,n.jsxs)(u.Hj,{children:[(0,n.jsx)(u.nd,{children:"Name"}),(0,n.jsx)(u.nd,{children:"Manufacturer"}),(0,n.jsx)(u.nd,{children:"Model"}),(0,n.jsx)(u.nd,{children:"Integration"}),(0,n.jsx)(u.nd,{children:"Status"})]})}),(0,n.jsx)(u.BF,{children:e.map(e=>(0,n.jsxs)(u.Hj,{children:[(0,n.jsx)(u.nA,{className:"font-medium",children:e.name}),(0,n.jsx)(u.nA,{children:e.manufacturer}),(0,n.jsx)(u.nA,{children:e.model}),(0,n.jsx)(u.nA,{children:(0,n.jsx)(h.E,{variant:"secondary",children:e.discovery_method})}),(0,n.jsx)(u.nA,{children:(0,n.jsx)(h.E,{variant:"default",children:"Online"})})]},e.id))})]})})]}),(0,n.jsxs)(l.Zp,{children:[(0,n.jsx)(l.aR,{children:(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(l.ZB,{children:"Entities"}),(0,n.jsx)(l.BT,{children:"Control your smart home entities"})]})})}),(0,n.jsx)(l.Wu,{children:(0,n.jsxs)(u.XI,{children:[(0,n.jsx)(u.A0,{children:(0,n.jsxs)(u.Hj,{children:[(0,n.jsx)(u.nd,{children:"Name"}),(0,n.jsx)(u.nd,{children:"Domain"}),(0,n.jsx)(u.nd,{children:"State"}),(0,n.jsx)(u.nd,{children:"Actions"})]})}),(0,n.jsx)(u.BF,{children:s.map(e=>{let t=c[e.entity_id];return(0,n.jsxs)(u.Hj,{children:[(0,n.jsx)(u.nA,{className:"font-medium",children:e.name}),(0,n.jsx)(u.nA,{children:(0,n.jsx)(h.E,{variant:"secondary",children:e.domain})}),(0,n.jsx)(u.nA,{children:t?(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 rounded-full ".concat("on"===t.state?"bg-green-500":"bg-gray-300")}),(0,n.jsx)("span",{children:t.state}),t.attributes&&Object.keys(t.attributes).length>0&&(0,n.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",Object.entries(t.attributes).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(s)}).join(", "),")"]})]}):(0,n.jsx)("span",{className:"text-muted-foreground",children:"Unknown"})}),(0,n.jsx)(u.nA,{children:"light"===e.domain||"switch"===e.domain?(0,n.jsx)(p.d,{checked:(null==t?void 0:t.state)==="on",onCheckedChange:()=>S(e)}):(0,n.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>w(e.entity_id,e.domain,"turn_on"),children:"Control"})})]},e.entity_id)})})]})})]})]})}var j=s(2188);function b(){let[e,t]=(0,a.useState)("integrations");return(0,n.jsx)(j.N,{children:(0,n.jsxs)("div",{className:"container mx-auto py-8",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Home Assistant Integrations"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage your smart home integrations and devices"})]}),(0,n.jsxs)(r.tU,{value:e,onValueChange:t,className:"w-full",children:[(0,n.jsxs)(r.j7,{className:"grid w-full grid-cols-2",children:[(0,n.jsx)(r.Xi,{value:"integrations",children:"Integrations"}),(0,n.jsx)(r.Xi,{value:"devices",children:"Devices & Entities"})]}),(0,n.jsx)(r.av,{value:"integrations",className:"mt-6",children:(0,n.jsx)(f,{})}),(0,n.jsx)(r.av,{value:"devices",className:"mt-6",children:(0,n.jsx)(v,{})})]})]})})}},7350:(e,t,s)=>{Promise.resolve().then(s.bind(s,6675))},8145:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var n=s(5155);s(2115);var a=s(9708),r=s(2085),i=s(3999);let l=(0,r.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,asChild:r=!1,...o}=e,c=r?a.DX:"span";return(0,n.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(l({variant:s}),t),...o})}},8524:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>l,Hj:()=>o,XI:()=>r,nA:()=>d,nd:()=>c});var n=s(5155);s(2115);var a=s(3999);function r(e){let{className:t,...s}=e;return(0,n.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,n.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",t),...s})})}function i(e){let{className:t,...s}=e;return(0,n.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",t),...s})}function l(e){let{className:t,...s}=e;return(0,n.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",t),...s})}function o(e){let{className:t,...s}=e;return(0,n.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function c(e){let{className:t,...s}=e;return(0,n.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function d(e){let{className:t,...s}=e;return(0,n.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}},9840:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>m,L3:()=>x,c7:()=>h,lG:()=>l,rr:()=>g,zM:()=>o});var n=s(5155);s(2115);var a=s(5452),r=s(4416),i=s(3999);function l(e){let{...t}=e;return(0,n.jsx)(a.bL,{"data-slot":"dialog",...t})}function o(e){let{...t}=e;return(0,n.jsx)(a.l9,{"data-slot":"dialog-trigger",...t})}function c(e){let{...t}=e;return(0,n.jsx)(a.ZL,{"data-slot":"dialog-portal",...t})}function d(e){let{className:t,...s}=e;return(0,n.jsx)(a.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function u(e){let{className:t,children:s,showCloseButton:l=!0,...o}=e;return(0,n.jsxs)(c,{"data-slot":"dialog-portal",children:[(0,n.jsx)(d,{}),(0,n.jsxs)(a.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o,children:[s,l&&(0,n.jsxs)(a.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,n.jsx)(r.A,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function h(e){let{className:t,...s}=e;return(0,n.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function m(e){let{className:t,...s}=e;return(0,n.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function x(e){let{className:t,...s}=e;return(0,n.jsx)(a.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...s})}function g(e){let{className:t,...s}=e;return(0,n.jsx)(a.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...s})}},9852:(e,t,s)=>{"use strict";s.d(t,{p:()=>r});var n=s(5155);s(2115);var a=s(3999);function r(e){let{className:t,type:s,...r}=e;return(0,n.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}}},e=>{var t=t=>e(e.s=t);e.O(0,[817,796,150,641,56,223,576,441,684,358],()=>t(7350)),_N_E=e.O()}]);